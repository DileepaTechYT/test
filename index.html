<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Bot Code Parser & Preview</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Helvetica+Neue:wght@400;500;700&display=swap');

        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Helvetica Neue', sans-serif;
            display: flex;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        /* Left Side - Controls */
        .controls {
            width: 50%;
            padding: 20px;
            background: #1e1e1e;
            overflow-y: auto;
            border-right: 1px solid #333;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        h2 { color: #00a884; border-bottom: 2px solid #00a884; padding-bottom: 10px; margin-top: 0; }
        
        .code-area {
            background: #111;
            border: 1px solid #00a884;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .code-area label { color: #00a884; margin-bottom: 8px; display: block; }
        
        .code-input {
            width: 100%;
            height: 150px;
            background: #222;
            color: #85e89d; /* Code color */
            font-family: 'Courier New', monospace;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 10px;
            resize: vertical;
            font-size: 13px;
            box-sizing: border-box;
        }

        .code-input:focus { outline: none; border-color: #00a884; }

        .manual-controls {
            opacity: 0.5;
            transition: 0.3s;
        }
        .manual-controls:hover { opacity: 1; }

        .input-group { margin-bottom: 10px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #aaa; font-size: 12px; }
        input, textarea.caption-input {
            width: 100%;
            padding: 8px;
            background: #2c2c2c;
            border: 1px solid #444;
            color: #fff;
            border-radius: 5px;
            box-sizing: border-box;
        }
        textarea.caption-input { height: 150px; font-family: monospace; white-space: pre; }
        input:focus, textarea:focus { outline: none; border-color: #00a884; }

        /* Right Side - Preview */
        .preview-area {
            width: 50%;
            background-color: #0b141a; 
            background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png');
            background-blend-mode: overlay;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .phone-screen {
            width: 380px;
            height: 80vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 20px;
        }

        /* Message Bubble */
        .message-bubble {
            background-color: #005c4b;
            border-radius: 10px;
            padding: 5px;
            max-width: 100%;
            position: relative;
            box-shadow: 0 1px 0.5px rgba(0,0,0,0.13);
            color: #e9edef;
            font-size: 14.2px;
            line-height: 19px;
        }

        /* Context Info */
        .context-info {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            padding: 10px;
            margin: 3px;
            display: flex;
            gap: 10px;
            cursor: pointer;
            border-left: 4px solid #dba617;
        }
        
        .context-img {
            width: 50px;
            height: 50px;
            border-radius: 5px;
            object-fit: cover;
            background: #333;
        }

        .context-text {
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow: hidden;
            flex: 1;
        }
        
        .context-title { font-weight: bold; color: #e9edef; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .context-body { color: #b4b4b4; font-size: 11px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* Document Preview */
        .document-preview {
            background-color: rgba(0, 0, 0, 0.1);
            border-radius: 6px;
            margin: 3px;
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .doc-icon {
            background: #ff5252;
            color: white;
            width: 40px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            font-size: 20px;
            font-weight: bold;
        }

        .doc-details { flex-grow: 1; overflow: hidden; }
        .doc-name { font-weight: 500; font-size: 14px; margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}
        .doc-meta { font-size: 11px; color: rgba(255,255,255,0.6); }

        /* Caption */
        .caption-text {
            padding: 5px 10px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .time {
            text-align: right;
            font-size: 11px;
            color: rgba(255,255,255,0.6);
            margin-top: -5px;
            padding-right: 5px;
            padding-bottom: 3px;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 3px;
        }

        .read-ticks { color: #53bdeb; font-size: 14px; }

    </style>
</head>
<body>

    <div class="controls">
        <h2>üõ†Ô∏è Bot Code Parser</h2>
        
        <div class="code-area">
            <label><i class="fas fa-code"></i> Paste Bot Code Here (JS)</label>
            <textarea id="rawCode" class="code-input" placeholder="Paste your conn.sendMessage(...) code here..." oninput="parseAndPreview()"></textarea>
        </div>

        <div class="manual-controls">
            <div style="font-size: 12px; color: #666; margin-bottom: 10px;">üëá Extracted Data (Editable)</div>

            <div class="input-group">
                <label>Ad Reply Title</label>
                <input type="text" id="adTitle" value="üöÄ ùöÄùöÑùô¥ùô¥ùôΩ ùô∏ùôºùô∞ùôªùöÇùô∑ùô∞ üöÄ" oninput="updatePreview()">
            </div>
            
            <div class="input-group">
                <label>Ad Reply Body</label>
                <input type="text" id="adBody" value="The Best WhatsApp Bot" oninput="updatePreview()">
            </div>

            <div class="input-group">
                <label>Thumbnail URL</label>
                <input type="text" id="thumbUrl" value="https://files.catbox.moe/letvwf.jpg" oninput="updatePreview()">
            </div>

            <hr style="border-color: #333; width: 100%;">

            <div class="input-group">
                <label>Document Name</label>
                <input type="text" id="docName" value="ùöÄùöÑùô¥ùô¥ùôΩ ùô∏ùôºùô∞ùôªùöÇùô∑ùô∞ ùôºùô¥ùôΩùöÑ" oninput="updatePreview()">
            </div>

            <div class="input-group">
                <label>Fake Size / Meta</label>
                <input type="text" id="docMeta" value="2024 Pages ‚Ä¢ PDF ‚Ä¢ 110 TB" oninput="updatePreview()">
            </div>

            <hr style="border-color: #333; width: 100%;">

            <div class="input-group">
                <label>Caption</label>
                <textarea id="caption" class="caption-input" oninput="updatePreview()">
*‚ï≠‚îÅ‚îÅ„Äî üöÄ ùöÄùöÑùô¥ùô¥ùôΩ ùô∏ùôºùô∞ùôªùöÇùô∑ùô∞ üöÄ „Äï‚îÅ‚îÅ‚îà‚ä∑*
*‚îÉ‚óÜ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ*
*‚îÉ‚óÜ‚îÇ üë§ ùöÑùöÇùô¥ùöÅ : User*
*‚îÉ‚óÜ‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ*
*·¥ò·¥è·¥°·¥á Ä·¥á·¥Ö  ô è «´·¥ú·¥á·¥á…¥ …™·¥ç·¥Ä üs ú·¥Ä*
                </textarea>
            </div>
        </div>
    </div>

    <div class="preview-area">
        <div class="phone-screen">
            <div class="message-bubble">
                
                <div class="context-info">
                    <img src="" id="prev-thumb" class="context-img">
                    <div class="context-text">
                        <div class="context-title" id="prev-ad-title"></div>
                        <div class="context-body" id="prev-ad-body"></div>
                    </div>
                </div>

                <div class="document-preview">
                    <div class="doc-icon"><i class="fas fa-file-pdf"></i></div>
                    <div class="doc-details">
                        <div class="doc-name" id="prev-doc-name"></div>
                        <div class="doc-meta" id="prev-doc-meta"></div>
                    </div>
                </div>

                <div class="caption-text" id="prev-caption"></div>
                
                <div class="time">
                    <span id="curr-time">10:45 AM</span> <span class="read-ticks"><i class="fas fa-check-double"></i></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Real-time Clock
        setInterval(() => {
            const now = new Date();
            document.getElementById('curr-time').innerText = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }, 1000);

        function parseAndPreview() {
            const code = document.getElementById('rawCode').value;
            if (!code.trim()) return; // Don't do anything if empty

            // --- REGEX PATTERNS TO FIND DATA IN CODE ---
            
            // 1. Extract Caption (matches text between backticks `...` or quotes "...")
            const captionMatch = code.match(/caption\s*:\s*[`"']([\s\S]*?)[`"']\s*(,|}|,|\))/);
            if (captionMatch) document.getElementById('caption').value = captionMatch[1];

            // 2. Extract Title (Context Info)
            const titleMatch = code.match(/title\s*:\s*["'](.*?)["']/);
            if (titleMatch) document.getElementById('adTitle').value = titleMatch[1];

            // 3. Extract Body (Context Info)
            const bodyMatch = code.match(/body\s*:\s*["'](.*?)["']/);
            if (bodyMatch) document.getElementById('adBody').value = bodyMatch[1];

            // 4. Extract Thumbnail URL
            const thumbMatch = code.match(/(thumbnailUrl|url|renderUrl)\s*:\s*["'](.*?)["']/);
            if (thumbMatch) document.getElementById('thumbUrl').value = thumbMatch[2];

            // 5. Extract File Name (Document)
            const docNameMatch = code.match(/fileName\s*:\s*["'](.*?)["']/);
            if (docNameMatch) document.getElementById('docName').value = docNameMatch[1];

            // Update the preview immediately after parsing
            updatePreview();
        }

        function updatePreview() {
            // Get values from input fields (which might have been populated by the parser)
            const adTitle = document.getElementById('adTitle').value;
            const adBody = document.getElementById('adBody').value;
            const thumbUrl = document.getElementById('thumbUrl').value;
            const docName = document.getElementById('docName').value;
            const docMeta = document.getElementById('docMeta').value;
            const caption = document.getElementById('caption').value;

            // Update UI Elements
            document.getElementById('prev-ad-title').innerText = adTitle;
            document.getElementById('prev-ad-body').innerText = adBody;
            
            // Check if URL is valid-ish, otherwise keep placeholder or hide
            if(thumbUrl.startsWith('http')) {
                document.getElementById('prev-thumb').src = thumbUrl;
                document.getElementById('prev-thumb').style.display = 'block';
            } else {
                document.getElementById('prev-thumb').style.display = 'none';
            }

            document.getElementById('prev-doc-name').innerText = docName;
            document.getElementById('prev-doc-meta').innerText = docMeta;

            // Formatting Logic
            let formattedCaption = caption
                .replace(/</g, "&lt;").replace(/>/g, "&gt;") // Prevent HTML injection
                .replace(/\*(.*?)\*/g, '<b>$1</b>') // Bold
                .replace(/_(.*?)_/g, '<i>$1</i>') // Italic
                .replace(/`(.*?)`/g, '<code>$1</code>') // Monospace
                .replace(/~ (.*?) ~/g, '<strike>$1</strike>') // Strike
                .replace(/\n/g, '<br>'); // New lines

            document.getElementById('prev-caption').innerHTML = formattedCaption;
        }

        // Init
        updatePreview();
    </script>
</body>
</html>
